---
layout: customPost
title:  "Git Step-5 : 원복(되돌리기)"
categories: 
  - Tools
  - Git
  
toc: true
toc_label: "Git Step-5 : 원복(되돌리기)"
toc_sticky: true 
---


## 1. Reset

지정된 커밋 상태로 되돌리는 명령어.

```
$git git reset -h
usage: git reset [--mixed | --soft | --hard | --merge | --keep] [-q] [<commit>]
   or: git reset [-q] [<tree-ish>] [--] <pathspec>...
   or: git reset [-q] [--pathspec-from-file [--pathspec-file-nul]] [<tree-ish>]
   or: git reset --patch [<tree-ish>] [--] [<pathspec>...]

    -q, --quiet           be quiet, only report errors
    --mixed               reset HEAD and index
    --soft                reset only HEAD
    --hard                reset HEAD, index and working tree
    --merge               reset HEAD, index and working tree
    --keep                reset HEAD but keep local changes
    --recurse-submodules[=<reset>]
                          control recursive updating of submodules
    -p, --patch           select hunks interactively
    -N, --intent-to-add   record only the fact that removed paths will be added later
    --pathspec-from-file <file>
                          read pathspec from file
    --pathspec-file-nul   with --pathspec-from-file, pathspec elements are separated with NUL character
```



```
$git reset [--soft | --mixed | --hard]  <commit>
```

reset 옵션 중 자주 사용되는 --soft, --mixed, --hard는 git의 3개의 영역을 옵션에 따라 reset합니다.

current는 지금 작업중인 내용이 유지되고, reset은 지정된 commit의 내용으로 변경됩니다.

![image-20210309105414618](/assets/images/posts/image-20210309105414618.png)



reset 명령 및 reset을 되돌리는 방법

```
$git log --oneline
0e3c111 (HEAD -> develop) modify 2
92fe575 modify

//92fe575 커밋으로 리셋
$git reset --hard 92fe575
$git log --oneline
92fe575 modify

//reflog로 리셋된 이력 확인. HEAD는 92fe575 커밋을 가리키고 있음.
$git reflog
92fe575 (HEAD -> develop) HEAD@{0}: reset: moving to 92fe575

//그래서 0e3c111 커밋으로 돌아가기 위해서는 HEAD로 reset해도 돌아갈 수 없음.
$git reset --hard HEAD
HEAD is now at 92fe575 modify

/*
위에서 reset HEAD로 한번 더 reset하였기 때문에 ORIG_HEAD는 reset전 92fe575를 가리키고 있음
따라서 위에서 reset HEAD 대신 reset ORIG_HEAD로 하였으면 0e3c111로 돌아갈 순 있었지만
지금 상황에서는 ORIG_HEAD가 92fe575을 가리키고 있기 때문에 돌아갈 수 없음.
*/
$git reset --hard ORIG_HEAD
HEAD is now at 92fe575 modify

//reflog로 이전 커밋을 찾아서 reset해야됨.
$git reflog
92fe575 (HEAD -> develop) HEAD@{0}: reset: moving to ORIG_HEAD
92fe575 (HEAD -> develop) HEAD@{1}: reset: moving to HEAD   
92fe575 (HEAD -> develop) HEAD@{2}: reset: moving to 92fe575
0e3c111 HEAD@{3}: reset: moving to ORIG_HEAD
92fe575 (HEAD -> develop) HEAD@{4}: reset: moving to 92fe575  
0e3c111 HEAD@{5}: commit: modify 2

//로그에서 변경하고 싶은 HEAD번호로 reset하면 됨.
$git reset --hard HEAD@{3}
HEAD is now at 0e3c111 modify 2

$git log --oneline
0e3c111 (HEAD -> develop) modify 2
92fe575 modify
```

